<?xml version="1.0" encoding="utf-8" ?>
<problem
        package="unix.files"
        id="read-file-fd-1"
        type="standard">
  <statement language="ru_RU">
    <description>
<p>Напишите функцию</p>
<pre>
struct FileContent
{
    ssize_t size;
    char *data;
};
struct FileContent read_file(int fd);</pre>
<p>Функция должна считать все содержимое файла по переданному файловому дескриптору.
В случае ошибки чтения поле <tt>size</tt> должно быть равно -1, а поле <tt>data</tt> — NULL.
В случае успешного чтения поле <tt>size</tt> должно содержать размер считанного файла,
поле <tt>data</tt> — указатель на считанные данные. Область памяти <tt>data</tt>
должна быть на 1 больше размера файла, и последний байт в области должен содержать
байт 0. Таким образом, текстовый файл в памяти будет хранится как строка (null-terminated string).</p>
<p>Ситуация нехватки памяти должна обрабатываться. В этом случае возвращаемое значение
такое же, как при ошибке чтения.</p>
<p>Для буферизации ввода используйте локальный буфер размера 4096 байт. <b>Размер первой аллокации должен быть не больше 4096 байтов, для больших размеров не гарантируется корректная работа тестов.</b></p>
<p>Используйте POSIX API работы с файлами.</p>
<p>Размер потребляемой памяти не должен превышать <tt>max(4096, 2 * размер_файла)</tt>.</p>
<p>Помните, что <tt>read</tt> не обязан всегда считывать ровно то количество байт,
которое было запрошено.</p>
<p>Гарантируется, что в тестах размер файлов, которые должны быть успешно обработаны, не превышает 10M.</p>
<p>При сдаче программы подключите заголовочный файл <a href="${getfile}=read_file.h"><tt>read_file.h</tt></a>.</p>
    </description>
  </statement>
<review_comments>
  <comment>Предпочитайте sizeof(value) выражению sizeof(type) или явному указанию константы размера</comment>
<comment>При перевыделении памяти с помощью realloc размер буфера следует умножать на константу</comment>
<comment>Обработку ошибок нужно производить в одном месте</comment>
<comment>Размер потребляемой памяти не должен превышать <tt>max(4096, 2 * размер_файла)</tt></comment>
</review_comments>
</problem>
